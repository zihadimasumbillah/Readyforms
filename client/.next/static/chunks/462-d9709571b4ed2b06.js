"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{5462:function(e,t,s){s.d(t,{O:function(){return S}});var r=s(7437),n=s(2265),a=s(9501),i=s(3590),l=s(1229),c=s(279),o=s(3448);let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});d.displayName="Textarea";var u=s(9270),m=s(401);let x=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(u.fC,{ref:t,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...n,children:(0,r.jsx)(u.z$,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})})});x.displayName=u.fC.displayName;var f=s(2381),h=s(935),p=s(5291),j=s(795),b=s(3662),g=s(9892),v=s(653),N=s(7413);function y(e){let{id:t,label:s,enabled:n,question:a,onToggle:i,onQuestionChange:l,onDelete:o,maxFields:d=4,currentFieldCount:u=0}=e,{attributes:m,listeners:h,setNodeRef:p,transform:j,transition:y}=(0,b.nB)({id:t}),w={transform:g.ux.Transform.toString(j),transition:y,opacity:n?1:.5};return(0,r.jsxs)("div",{ref:p,style:w,className:"mb-4 border rounded-md p-4 bg-background",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{...m,...h,className:"cursor-grab p-1",children:(0,r.jsx)(v.W1P,{className:"h-5 w-5 text-muted-foreground"})}),(0,r.jsx)("h4",{className:"font-medium",children:s})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[u&&u>1&&(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:o,className:"h-8 w-8 p-0",title:"Remove question",children:(0,r.jsx)(N.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,r.jsx)(x,{id:"toggle-".concat(t),checked:n,onCheckedChange:i})]})]}),(0,r.jsx)("div",{className:"transition-all ".concat(n?"opacity-100":"opacity-50"),children:(0,r.jsx)(c.I,{value:a,onChange:e=>l(e.target.value),placeholder:"Enter question text",disabled:!n,className:"mt-2"})})]})}var w=s(285),k=s(8752);let C=l.Ry({title:l.Z_().min(3,{message:"Title must be at least 3 characters"}),description:l.Z_(),topicId:l.Z_().min(1,{message:"Please select a topic"}),isPublic:l.O7().default(!0),allowedUsers:l.Z_().optional()}),S=e=>{let{initialData:t,topics:s,onSubmit:l,submitButtonLabel:o,isEditMode:u=!1}=e,[m,g]=(0,n.useState)(t||{}),[v,N]=(0,n.useState)((null==t?void 0:t.questionOrder)?JSON.parse(t.questionOrder):[]),[S,I]=(0,n.useState)(!1),z=(0,a.cI)({resolver:(0,i.F)(C),defaultValues:{title:(null==t?void 0:t.title)||"",description:(null==t?void 0:t.description)||"",topicId:(null==t?void 0:t.topicId)||"",isPublic:(null==t?void 0:t.isPublic)===void 0||t.isPublic,allowedUsers:(null==t?void 0:t.allowedUsers)||""}}),F=(0,j.Dy)((0,j.VT)(j.we),(0,j.VT)(j.Lg,{coordinateGetter:b.is})),T=(e,t)=>{if(!m)return;let s="".concat(e,"State");g({...m,[s]:t}),t&&!v.includes(e)&&N([...v,e])},P=(e,t)=>{m&&g({...m,["".concat(e,"Question")]:t})},R=e=>{if(m){for(let t=1;t<=4;t++){let s="custom".concat(e).concat(t),r="".concat(s,"State");if(!m[r]){T(s,!0);let t="".concat(s,"Question");g({...m,[r]:!0,[t]:"New ".concat(e," Question")}),v.includes(s)||N([...v,s]);return}}(0,k.Am)({title:"Maximum fields reached",description:"You can have at most 4 ".concat(e.toLowerCase()," questions."),variant:"default"})}},q=e=>{m&&(g({...m,["".concat(e,"State")]:!1}),N(v.filter(t=>t!==e)))},A=e=>{if(!m)return 0;let t=0;for(let s=1;s<=4;s++)m["custom".concat(e).concat(s,"State")]&&t++;return t},E=async e=>{try{I(!0);let t={...e,version:m.version,questionOrder:JSON.stringify(v)};for(let e=1;e<=4;e++)["String","Text","Int","Checkbox"].forEach(s=>{let r="custom".concat(s).concat(e),n="".concat(r,"State"),a="".concat(r,"Question");t[n]=m[n]||!1,t[a]=m[a]||""});await l(t)}catch(e){console.error("Error saving template:",e),(0,k.Am)({title:"Error",description:"Failed to save template. Please try again.",variant:"destructive"})}finally{I(!1)}};return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(h.l0,{...z,children:(0,r.jsxs)("form",{onSubmit:z.handleSubmit(E),className:"space-y-6",children:[(0,r.jsx)(h.Wi,{control:z.control,name:"title",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.xJ,{children:[(0,r.jsx)(h.lX,{children:"Template Title"}),(0,r.jsx)(h.NI,{children:(0,r.jsx)(c.I,{placeholder:"Enter template title",...t})}),(0,r.jsx)(h.zG,{})]})}}),(0,r.jsx)(h.Wi,{control:z.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.xJ,{children:[(0,r.jsx)(h.lX,{children:"Description"}),(0,r.jsx)(h.NI,{children:(0,r.jsx)(d,{placeholder:"Enter a description of this template",...t})}),(0,r.jsx)(h.zG,{})]})}}),(0,r.jsx)(h.Wi,{control:z.control,name:"topicId",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.xJ,{children:[(0,r.jsx)(h.lX,{children:"Topic"}),(0,r.jsxs)(p.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,r.jsx)(h.NI,{children:(0,r.jsx)(p.i4,{children:(0,r.jsx)(p.ki,{placeholder:"Select a topic"})})}),(0,r.jsx)(p.Bw,{children:s.map(e=>(0,r.jsx)(p.Ql,{value:e.id,children:e.name},e.id))})]}),(0,r.jsx)(h.zG,{})]})}}),(0,r.jsx)(h.Wi,{control:z.control,name:"isPublic",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,r.jsx)(h.NI,{children:(0,r.jsx)(x,{checked:t.value,onCheckedChange:t.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(h.lX,{children:"Make this template public"}),(0,r.jsx)(h.pf,{children:"Public templates are visible to all users. Private templates are only visible to you."})]})]})}}),(0,r.jsxs)("div",{className:"bg-muted/20 border rounded-md p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Questions"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add and configure questions for your form"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>R("String"),disabled:A("String")>=4,className:"gap-1",type:"button",children:[(0,r.jsx)(w.Z,{className:"h-3.5 w-3.5"}),"Add Text Field"]}),(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>R("Text"),disabled:A("Text")>=4,className:"gap-1",type:"button",children:[(0,r.jsx)(w.Z,{className:"h-3.5 w-3.5"}),"Add Text Area"]}),(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>R("Int"),disabled:A("Int")>=4,className:"gap-1",type:"button",children:[(0,r.jsx)(w.Z,{className:"h-3.5 w-3.5"}),"Add Number"]}),(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>R("Checkbox"),disabled:A("Checkbox")>=4,className:"gap-1",type:"button",children:[(0,r.jsx)(w.Z,{className:"h-3.5 w-3.5"}),"Add Checkbox"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2 py-2",children:[(0,r.jsx)(j.LB,{sensors:F,collisionDetection:j.pE,onDragEnd:e=>{let{active:t,over:s}=e;s&&t.id!==s.id&&N(e=>{let r=e.indexOf(t.id.toString()),n=e.indexOf(s.id.toString());return(0,b.Rp)(e,r,n)})},children:(0,r.jsx)(b.Fo,{items:v,strategy:b.qw,children:v.map(e=>{let t;let s="".concat(e,"State"),n="".concat(e,"Question"),a=e.match(/custom([A-Za-z]+)(\d)/);if(!a)return null;let[,i,l]=a;switch(i){case"String":t="Text Field ".concat(l);break;case"Text":t="Text Area ".concat(l);break;case"Int":t="Number ".concat(l);break;case"Checkbox":t="Checkbox ".concat(l);break;default:t="Question ".concat(l)}return(0,r.jsx)(y,{id:e,label:t,enabled:m[s]||!1,question:m[n]||"",onToggle:t=>T(e,t),onQuestionChange:t=>P(e,t),onDelete:()=>q(e),currentFieldCount:v.filter(e=>e.includes(i)).length,maxFields:4},e)})})}),0===v.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-lg font-medium text-muted-foreground",children:"No questions yet"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Add questions using the buttons above"})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end space-x-2",children:(0,r.jsx)(f.z,{type:"submit",disabled:S,children:S?"Saving...":o})})]})})})})}},935:function(e,t,s){s.d(t,{l0:function(){return u},NI:function(){return b},pf:function(){return g},Wi:function(){return x},xJ:function(){return p},lX:function(){return j},zG:function(){return v}});var r=s(7437),n=s(2265),a=s(7053),i=s(9501),l=s(3448),c=s(6394);let o=(0,s(535).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(c.f,{ref:t,className:(0,l.cn)(o(),s),...n})});d.displayName=c.f.displayName;let u=i.RV,m=n.createContext({}),x=e=>{let{...t}=e;return(0,r.jsx)(m.Provider,{value:{name:t.name},children:(0,r.jsx)(i.Qr,{...t})})},f=()=>{let e=n.useContext(m),t=n.useContext(h),{getFieldState:s,formState:r}=(0,i.Gc)(),a=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...a}},h=n.createContext({}),p=n.forwardRef((e,t)=>{let{className:s,...a}=e,i=n.useId();return(0,r.jsx)(h.Provider,{value:{id:i},children:(0,r.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",s),...a})})});p.displayName="FormItem";let j=n.forwardRef((e,t)=>{let{className:s,...n}=e,{error:a,formItemId:i}=f();return(0,r.jsx)(d,{ref:t,className:(0,l.cn)(a&&"text-destructive",s),htmlFor:i,...n})});j.displayName="FormLabel";let b=n.forwardRef((e,t)=>{let{...s}=e,{error:n,formItemId:i,formDescriptionId:l,formMessageId:c}=f();return(0,r.jsx)(a.g7,{ref:t,id:i,"aria-describedby":n?"".concat(l," ").concat(c):"".concat(l),"aria-invalid":!!n,...s})});b.displayName="FormControl";let g=n.forwardRef((e,t)=>{let{className:s,...n}=e,{formDescriptionId:a}=f();return(0,r.jsx)("p",{ref:t,id:a,className:(0,l.cn)("text-sm text-muted-foreground",s),...n})});g.displayName="FormDescription";let v=n.forwardRef((e,t)=>{let{className:s,children:n,...a}=e,{error:i,formMessageId:c}=f(),o=i?String(null==i?void 0:i.message):n;return o?(0,r.jsx)("p",{ref:t,id:c,className:(0,l.cn)("text-sm font-medium text-destructive",s),...a,children:o}):null});v.displayName="FormMessage"}}]);