(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{576:function(e,t,r){Promise.resolve().then(r.bind(r,2850))},2451:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},2735:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},8736:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},5466:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},7692:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},8728:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3578:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},2369:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4369:function(e,t,r){"use strict";var a=r(2265),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useState,l=a.useEffect,i=a.useLayoutEffect,o=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=s({inst:{value:r,getSnapshot:t}}),n=a[0].inst,d=a[1];return i(function(){n.value=r,n.getSnapshot=t,c(n)&&d({inst:n})},[e,r,t]),l(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),o(r),r};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:d},2558:function(e,t,r){"use strict";e.exports=r(4369)},2850:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var a=r(7437),n=r(2265),s=r(2573),l=r(9820),i=r(2381),o=r(6861),c=r(7491),d=r(9140),u=r(2451);let m=(0,r(9763).Z)("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);var h=r(2735),f=r(5805),p=r(9376),x=r(4881),y=r(8752),v=r(3804),g=r(7648);function j(e){let{params:t}=e,[r,j]=(0,n.useState)(!0),[w,b]=(0,n.useState)(null),[N,k]=(0,n.useState)([]),[Z,S]=(0,n.useState)(null),A=(0,p.useRouter)(),E=(0,x.a)(),R=null==E?void 0:E.user,T=t.id;function C(e){return e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}return((0,n.useEffect)(()=>{let e=async()=>{try{j(!0);let e=await o.t.getTemplateById(T);if(b(e),e&&e.userId!==(null==R?void 0:R.id)&&!(null==R?void 0:R.isAdmin)){(0,y.Am)({title:"Access denied",description:"You don't have permission to view responses for this template.",variant:"destructive"}),A.push("/templates/".concat(T));return}if(e){let e=await c.w.getResponsesByTemplateId(T);k(e);let t=await c.w.getAggregateData(T);S(t)}else(0,y.Am)({title:"Template not found",description:"The requested template could not be found.",variant:"destructive"})}catch(e){console.error("Error fetching data:",e),(0,y.Am)({title:"Error",description:"Failed to load responses. Please try again.",variant:"destructive"})}finally{j(!1)}};R?e():A.push("/auth/login")},[T,R,A]),R)?(0,a.jsxs)(s.c,{user:{name:R.name,email:R.email,isAdmin:R.isAdmin},onLogout:()=>{null==E||E.logout(),A.push("/auth/login")},children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>A.push("/templates/".concat(T)),children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Back to Template"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>A.push("/templates/".concat(T,"/statistics")),children:[(0,a.jsx)(m,{className:"mr-2 h-4 w-4"}),"Statistics"]}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:function(){if(!N.length)return;let e=new Set;N.forEach(t=>{Object.keys(t).forEach(t=>{["id","templateId","userId","createdAt","updatedAt","template","user"].includes(t)||e.add(t)})});let t=["ID","Submitted By","Submission Date",...Array.from(e)],r=N.map(t=>{var r;let a=[t.id,(null===(r=t.user)||void 0===r?void 0:r.name)||"Anonymous",C(t.createdAt)];return Array.from(e).forEach(e=>{let r=t[e];a.push(void 0!==r?r:"")}),a}),a=new Blob([[t.join(","),...r.map(e=>e.map(e=>'"'.concat(e,'"')).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(a),s=document.createElement("a");s.setAttribute("href",n),s.setAttribute("download","".concat((null==w?void 0:w.title)||"template","-responses.csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},disabled:!N.length,children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})]}),r?(0,a.jsx)(d.O,{className:"h-8 w-2/3"}):(0,a.jsxs)("h1",{className:"text-2xl font-bold",children:["Responses: ",null==w?void 0:w.title]})]}),(0,a.jsxs)(l.Zb,{className:"mb-6",children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)(l.ll,{className:"text-xl",children:"Response Summary"})})}),(0,a.jsx)(l.aY,{children:r?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(d.O,{className:"h-24 w-full"},t))}):(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-muted/50 p-4 rounded-md",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Responses"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:N.length})]}),(null==w?void 0:w.isQuiz)&&(0,a.jsxs)("div",{className:"bg-muted/50 p-4 rounded-md",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Average Score"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==Z?void 0:Z.avg_score)?"".concat(Math.round(10*Z.avg_score)/10,"/").concat(Math.round(Z.avg_total_points)):"N/A"})]}),(0,a.jsxs)("div",{className:"bg-muted/50 p-4 rounded-md",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Latest Response"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:N.length>0?C(N[0].createdAt):"No responses yet"})]})]})})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsxs)(l.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 mr-2"}),"All Responses"]})}),(0,a.jsx)(l.aY,{children:r?(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(d.O,{className:"h-12 w-full"},t))}):N.length>0?(0,a.jsxs)(v.iA,{children:[(0,a.jsx)(v.Rn,{children:"A list of all responses for this template."}),(0,a.jsx)(v.xD,{children:(0,a.jsxs)(v.SC,{children:[(0,a.jsx)(v.ss,{children:"Respondent"}),(0,a.jsx)(v.ss,{children:"Date Submitted"}),(null==w?void 0:w.isQuiz)&&(0,a.jsx)(v.ss,{children:"Score"}),(0,a.jsx)(v.ss,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(v.RM,{children:N.map(e=>{var t;return(0,a.jsxs)(v.SC,{children:[(0,a.jsx)(v.pj,{className:"font-medium",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"Anonymous"}),(0,a.jsx)(v.pj,{children:C(e.createdAt)}),(null==w?void 0:w.isQuiz)&&(0,a.jsx)(v.pj,{children:void 0!==e.score&&void 0!==e.totalPossiblePoints?(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.score,"/",e.totalPossiblePoints]}),(0,a.jsxs)("span",{className:"ml-2 text-sm text-muted-foreground",children:["(",Math.round(e.score/e.totalPossiblePoints*100),"%)"]})]}):"N/A"}),(0,a.jsx)(v.pj,{className:"text-right",children:(0,a.jsx)(i.z,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsx)(g.default,{href:"/templates/".concat(T,"/responses/").concat(e.id),children:"View Details"})})})]},e.id)})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)(f.Z,{className:"h-16 w-16 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium",children:"No responses yet"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"There are no responses to this template yet."})]})})]})]}):(0,a.jsx)("div",{children:"Loading..."})}},9140:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});var a=r(7437),n=r(3448);function s(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-muted",t),...r})}},3804:function(e,t,r){"use strict";r.d(t,{RM:function(){return o},Rn:function(){return m},SC:function(){return c},iA:function(){return l},pj:function(){return u},ss:function(){return d},xD:function(){return i}});var a=r(7437),n=r(2265),s=r(3448);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{className:"w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",r),...n})})});l.displayName="Table";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",r),...n})});i.displayName="TableHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...n})});o.displayName="TableBody",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,s.cn)("bg-primary font-medium text-primary-foreground",r),...n})}).displayName="TableFooter";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n})});c.displayName="TableRow";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n})});d.displayName="TableHead";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n})});u.displayName="TableCell";let m=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...n})});m.displayName="TableCaption"},7491:function(e,t,r){"use strict";r.d(t,{w:function(){return n}});var a=r(9642);let n={getResponsesByTemplateId:async e=>(await a.Z.get("/responses/template/".concat(e))).data,getResponseById:async e=>(await a.Z.get("/responses/".concat(e))).data,getUserResponses:async()=>(await a.Z.get("/responses/user")).data,submitResponse:async e=>(await a.Z.post("/responses",e)).data,getAggregateData:async e=>(await a.Z.get("/responses/aggregate/".concat(e))).data,async deleteResponse(e){await a.Z.delete("/responses/".concat(e))}}},6861:function(e,t,r){"use strict";r.d(t,{t:function(){return n}});var a=r(9642);let n={async getTemplates(e){try{return(await a.Z.get("/templates",{params:e})).data}catch(e){return console.error("Error fetching templates:",e),[]}},async getTemplateById(e){try{return(await a.Z.get("/templates/".concat(e))).data}catch(t){return console.error("Error fetching template ".concat(e,":"),t),null}},async searchTemplates(e,t){try{let r={query:e,limit:(null==t?void 0:t.limit)||10,page:(null==t?void 0:t.page)||1,topicId:null==t?void 0:t.topicId,tag:null==t?void 0:t.tag,sort:(null==t?void 0:t.sort)||"newest"};return(await a.Z.get("/templates/search",{params:r})).data}catch(e){return console.error("Error searching templates:",e),[]}},async getFeaturedTemplates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;try{return(await a.Z.get("/templates",{params:{limit:e,page:1}})).data}catch(e){return console.error("Error fetching featured templates:",e),[]}},async getTemplatesByTopic(e,t){try{return(await a.Z.get("/templates/search",{params:{topicId:e,limit:(null==t?void 0:t.limit)||10,page:(null==t?void 0:t.page)||1}})).data}catch(t){return console.error("Error fetching templates for topic ".concat(e,":"),t),[]}},async deleteTemplate(e,t){try{return await a.Z.delete("/templates/".concat(e),{data:{version:t}}),!0}catch(t){throw console.error("Error deleting template ".concat(e,":"),t),t}},async createTemplate(e){try{return(await a.Z.post("/templates",e)).data}catch(e){throw console.error("Error creating template:",e),e}},async updateTemplate(e,t){try{return(await a.Z.put("/templates/".concat(e),t)).data.template}catch(t){throw console.error("Error updating template ".concat(e,":"),t),t}}}},1146:function(e,t,r){"use strict";r.d(t,{NY:function(){return k},Ee:function(){return N},fC:function(){return b}});var a=r(2265),n=r(3966),s=r(6606),l=r(1188),i=r(6840),o=r(2558);function c(){return()=>{}}var d=r(7437),u="Avatar",[m,h]=(0,n.b)(u),[f,p]=m(u),x=a.forwardRef((e,t)=>{let{__scopeAvatar:r,...n}=e,[s,l]=a.useState("idle");return(0,d.jsx)(f,{scope:r,imageLoadingStatus:s,onImageLoadingStatusChange:l,children:(0,d.jsx)(i.WV.span,{...n,ref:t})})});x.displayName=u;var y="AvatarImage",v=a.forwardRef((e,t)=>{let{__scopeAvatar:r,src:n,onLoadingStatusChange:u=()=>{},...m}=e,h=p(y,r),f=function(e,t){let{referrerPolicy:r,crossOrigin:n}=t,s=(0,o.useSyncExternalStore)(c,()=>!0,()=>!1),i=a.useRef(null),d=s?(i.current||(i.current=new window.Image),i.current):null,[u,m]=a.useState(()=>w(d,e));return(0,l.b)(()=>{m(w(d,e))},[d,e]),(0,l.b)(()=>{let e=e=>()=>{m(e)};if(!d)return;let t=e("loaded"),a=e("error");return d.addEventListener("load",t),d.addEventListener("error",a),r&&(d.referrerPolicy=r),"string"==typeof n&&(d.crossOrigin=n),()=>{d.removeEventListener("load",t),d.removeEventListener("error",a)}},[d,n,r]),u}(n,m),x=(0,s.W)(e=>{u(e),h.onImageLoadingStatusChange(e)});return(0,l.b)(()=>{"idle"!==f&&x(f)},[f,x]),"loaded"===f?(0,d.jsx)(i.WV.img,{...m,ref:t,src:n}):null});v.displayName=y;var g="AvatarFallback",j=a.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:n,...s}=e,l=p(g,r),[o,c]=a.useState(void 0===n);return a.useEffect(()=>{if(void 0!==n){let e=window.setTimeout(()=>c(!0),n);return()=>window.clearTimeout(e)}},[n]),o&&"loaded"!==l.imageLoadingStatus?(0,d.jsx)(i.WV.span,{...s,ref:t}):null});function w(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}j.displayName=g;var b=x,N=v,k=j}},function(e){e.O(0,[284,464,972,513,832,331,128,713,582,971,117,744],function(){return e(e.s=576)}),_N_E=e.O()}]);