(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{54435:function(e,t,s){Promise.resolve().then(s.bind(s,83439))},83439:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N},dynamic:function(){return v},dynamicParams:function(){return j}});var a=s(57437),i=s(2265),n=s(79820),l=s(12381),r=s(25462),c=s(82506),d=s(76861),o=s(20154),m=s(99376),u=s(18752),p=s(5894),h=s(92451),x=s(27648),f=s(69140);let v="force-dynamic",j=!0;function N(e){let{params:t}=e,[s,v]=(0,i.useState)(null),[j,N]=(0,i.useState)([]),[y,b]=(0,i.useState)(!0),w=(0,m.useRouter)(),g=(0,p.a)(),E=null==g?void 0:g.user;(0,i.useEffect)(()=>{(async()=>{try{b(!0);let e=await d.ZP.getById(t.id);v(e);let s=await o.wE.getAllTopics();N(s),E&&e&&e.userId!==E.id&&!E.isAdmin&&((0,u.Am)({title:"Access Denied",description:"You don't have permission to edit this template.",variant:"destructive"}),w.push("/templates/".concat(t.id)))}catch(e){console.error("Error fetching template data:",e),(0,u.Am)({title:"Error",description:"Failed to load template. Please try again.",variant:"destructive"}),w.push("/templates")}finally{b(!1)}})()},[t.id,w,E]);let O=async e=>{try{if(!s||void 0===s.version){(0,u.Am)({title:"Error",description:"Template information is missing. Please try again.",variant:"destructive"});return}let a={...e,version:s.version};await d.ZP.updateTemplate(t.id,a),(0,u.Am)({title:"Success",description:"Template updated successfully."}),w.push("/templates/".concat(t.id))}catch(e){var a;console.error("Error updating template:",e),(null===(a=e.response)||void 0===a?void 0:a.status)===409?(0,u.Am)({title:"Update Conflict",description:"This template has been modified by someone else. Please refresh and try again.",variant:"destructive"}):(0,u.Am)({title:"Error",description:"Failed to update template. Please try again.",variant:"destructive"})}};return E?(0,a.jsxs)("div",{className:"min-h-screen bg-muted/40",children:[(0,a.jsx)(c.w,{}),(0,a.jsxs)("div",{className:"container py-6 max-w-5xl",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)(x.default,{href:"/templates/".concat(t.id),className:"flex items-center text-sm text-muted-foreground hover:text-primary",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-1"}),"Back to Template"]})}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{className:"text-2xl",children:"Edit Template"}),(0,a.jsx)(n.SZ,{children:"Update your form template below."})]}),(0,a.jsx)(n.aY,{children:y?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.O,{className:"h-4 w-[200px]"}),(0,a.jsx)(f.O,{className:"h-10 w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.O,{className:"h-4 w-[150px]"}),(0,a.jsx)(f.O,{className:"h-10 w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.O,{className:"h-4 w-[120px]"}),(0,a.jsx)(f.O,{className:"h-32 w-full"})]})]}):s&&(0,a.jsx)(r.O,{initialData:s,topics:j,onSubmit:O,submitButtonLabel:"Update Template"})})]})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Authentication Required"}),(0,a.jsx)("p",{className:"mb-4",children:"Please log in to edit templates."}),(0,a.jsx)(l.z,{onClick:()=>w.push("/auth/login"),children:"Log In"})]})})}},69140:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var a=s(57437),i=s(93448);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("animate-pulse rounded-md bg-muted",t),...s})}}},function(e){e.O(0,[310,597,448,617,564,478,501,663,348,994,727,975,28,971,117,744],function(){return e(e.s=54435)}),_N_E=e.O()}]);