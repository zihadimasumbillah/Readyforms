(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{9032:function(e,t,s){Promise.resolve().then(s.bind(s,3280))},3280:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return U}});var r=s(7437),a=s(2265),n=s(9376),i=s(4881),o=s(6861),l=s(154),c=s(2381),d=s(279),u=s(3675),m=s(721),p=s(3448);let f=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(m.fC,{className:(0,p.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:(0,r.jsx)(m.bU,{className:(0,p.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});f.displayName=m.fC.displayName;var h=s(5060),x=s(3402),g=s(875),v=s(2135),y=s(401);let j=x.fC;x.ZA;let b=x.B4,w=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(x.xz,{ref:t,className:(0,p.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[a,(0,r.jsx)(x.JO,{asChild:!0,children:(0,r.jsx)(g.Z,{className:"h-4 w-4 opacity-50"})})]})});w.displayName=x.xz.displayName;let N=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(x.u_,{ref:t,className:(0,p.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(v.Z,{className:"h-4 w-4"})})});N.displayName=x.u_.displayName;let S=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(x.$G,{ref:t,className:(0,p.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(g.Z,{className:"h-4 w-4"})})});S.displayName=x.$G.displayName;let k=a.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",...i}=e;return(0,r.jsx)(x.h_,{children:(0,r.jsxs)(x.VY,{ref:t,className:(0,p.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,r.jsx)(N,{}),(0,r.jsx)(x.l_,{className:(0,p.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(S,{})]})})});k.displayName=x.VY.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(x.__,{ref:t,className:(0,p.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=x.__.displayName;let C=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(x.ck,{ref:t,className:(0,p.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(x.wU,{children:(0,r.jsx)(y.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(x.eT,{children:a})]})});C.displayName=x.ck.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(x.Z0,{ref:t,className:(0,p.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=x.Z0.displayName;var T=s(9820),A=s(8752),E=s(7168),Z=s(9174),I=s(1905),_=s(2489),q=s(9397),R=s(2208),z=s(5863),P=s(3229),O=s(795),F=s(3662),D=s(9892);function Q(e){let{field:t,onUpdateField:s,onRemoveField:a,isQuizMode:n}=e,{attributes:i,listeners:o,setNodeRef:l,transform:u,transition:m}=(0,F.nB)({id:t.id}),p={transform:D.ux.Transform.toString(u),transition:m},x=t.type.charAt(0).toUpperCase()+t.type.slice(1);return(0,r.jsxs)("div",{ref:l,style:p,className:"bg-background border rounded-md p-4 mb-3 relative",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("div",{...i,...o,className:"cursor-grab",children:(0,r.jsx)(I.Z,{className:"h-5 w-5 text-muted-foreground"})}),(0,r.jsxs)(Z.C,{variant:"outline",className:"font-normal",children:[x," question"]}),(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,r.jsx)(f,{id:"active-".concat(t.id),checked:t.isActive,onCheckedChange:e=>s({...t,isActive:e})}),(0,r.jsx)(h._,{htmlFor:"active-".concat(t.id),children:"Active"}),(0,r.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>a(t.id),className:"h-8 w-8 p-0 ml-2",children:(0,r.jsx)(_.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"question-".concat(t.id),children:"Question"}),(0,r.jsx)(d.I,{id:"question-".concat(t.id),value:t.question,onChange:e=>s({...t,question:e.target.value}),placeholder:"Enter your ".concat(x.toLowerCase()," question"),className:"mt-1"})]}),n&&(0,r.jsxs)("div",{className:"bg-muted/50 p-3 rounded-md space-y-3 border",children:[(0,r.jsx)("h4",{className:"text-sm font-medium",children:"Scoring options"}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(h._,{htmlFor:"answer-".concat(t.id),children:"Correct Answer"}),"String"===t.type||"Text"===t.type?(0,r.jsx)(d.I,{id:"answer-".concat(t.id),value:t.answer||"",onChange:e=>s({...t,answer:e.target.value}),placeholder:"Enter correct answer"}):"Int"===t.type?(0,r.jsx)(d.I,{id:"answer-".concat(t.id),type:"number",value:t.answer||"",onChange:e=>s({...t,answer:Number(e.target.value)}),placeholder:"Enter correct number"}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(f,{id:"answer-".concat(t.id),checked:t.answer||!1,onCheckedChange:e=>s({...t,answer:e})}),(0,r.jsx)(h._,{htmlFor:"answer-".concat(t.id),children:"True/Yes is correct"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h._,{htmlFor:"points-".concat(t.id),children:"Points"}),(0,r.jsx)(d.I,{id:"points-".concat(t.id),type:"number",min:"0",step:"1",value:t.points||0,onChange:e=>s({...t,points:Number(e.target.value)}),className:"mt-1"})]})]})]})]})}function U(){var e;let t=(0,n.useRouter)(),{user:s}=(0,i.a)()||{},[m,p]=(0,a.useState)(""),[x,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(!0),[N,S]=(0,a.useState)(""),[I,D]=(0,a.useState)([]),[U,V]=(0,a.useState)(""),[L,Y]=(0,a.useState)([]),[B,M]=(0,a.useState)([]),[W,J]=(0,a.useState)(!1),[G,$]=(0,a.useState)(!1),[H,K]=(0,a.useState)("basic"),[X,ee]=(0,a.useState)(!1),[et,es]=(0,a.useState)(!0),er=(0,O.Dy)((0,O.VT)(O.we),(0,O.VT)(O.Lg,{coordinateGetter:F.is}));(0,a.useEffect)(()=>{(async()=>{try{es(!0);let e=await l.wE.getAllTopics();D(e),e.length>0&&S(e[0].id)}catch(e){console.error("Failed to fetch topics:",e),(0,A.Am)({title:"Error",description:"Failed to load topics. Please try again.",variant:"destructive"})}finally{es(!1)}})()},[]),(0,a.useEffect)(()=>{s||t.push("/auth/login?redirect=/templates/create")},[s,t]);let ea=()=>"field_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),en=e=>{let t=B.filter(t=>t.type===e).length+1;M([...B,{id:ea(),type:e,index:t,question:"",isActive:!0,answer:"Checkbox"!==e&&"",points:1}])},ei=e=>{M(B.map(t=>t.id===e.id?e:t))},eo=e=>{M(B.filter(t=>t.id!==e))},el=()=>{U.trim()&&!L.includes(U.trim())&&(Y([...L,U.trim()]),V(""))},ec=e=>{Y(L.filter(t=>t!==e))},ed=()=>{let e=B.filter(e=>e.isActive).map(e=>"custom".concat(e.type).concat(e.index)),t={};W&&B.filter(e=>e.isActive).forEach(e=>{t["custom".concat(e.type).concat(e.index,"Answer")]={answer:e.answer,points:e.points||0}});let s={title:m,description:x,isPublic:v,topicId:N,tags:L,isQuiz:W,showScoreImmediately:W&&G,scoringCriteria:W?JSON.stringify(t):"{}",questionOrder:JSON.stringify(e)};return B.forEach(e=>{let t="custom".concat(e.type).concat(e.index,"State"),r="custom".concat(e.type).concat(e.index,"Question");s[t]=e.isActive,s[r]=e.question}),s},eu=async e=>{if(e.preventDefault(),!m.trim()){(0,A.Am)({title:"Error",description:"Template title is required",variant:"destructive"});return}if(!N){(0,A.Am)({title:"Error",description:"Please select a topic",variant:"destructive"});return}let s=B.filter(e=>e.isActive);if(0===s.length){(0,A.Am)({title:"Error",description:"Please add at least one question to your template",variant:"destructive"});return}if(s.filter(e=>!e.question.trim()).length>0){(0,A.Am)({title:"Error",description:"All active questions must have content",variant:"destructive"});return}if(W&&s.filter(e=>"String"===e.type||"Text"===e.type?!e.answer||""===e.answer.trim():"Int"===e.type&&(void 0===e.answer||null===e.answer)).length>0){(0,A.Am)({title:"Error",description:"All quiz questions must have correct answers defined",variant:"destructive"});return}try{ee(!0);let e=ed(),s=await o.t.createTemplate(e);(0,A.Am)({title:"Success",description:"Template created successfully"}),s?t.push("/templates/".concat(s.id)):((0,A.Am)({title:"Warning",description:"Template was created but we couldn't get the template details.",variant:"default"}),t.push("/templates"))}catch(e){var r,a;console.error("Failed to create template:",e),(0,A.Am)({title:"Error",description:(null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to create template. Please try again.",variant:"destructive"})}finally{ee(!1)}},em=[...B].sort((e,t)=>e.type!==t.type?e.type.localeCompare(t.type):e.index-t.index);return(em.filter(e=>"String"===e.type),em.filter(e=>"Text"===e.type),em.filter(e=>"Int"===e.type),em.filter(e=>"Checkbox"===e.type),s)?(0,r.jsxs)("div",{className:"container py-8 max-w-4xl",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Create Template"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Create a new form template for users to fill out"})]}),(0,r.jsx)("form",{onSubmit:eu,children:(0,r.jsxs)(E.mQ,{value:H,onValueChange:K,className:"space-y-4",children:[(0,r.jsxs)(E.dr,{className:"grid w-full grid-cols-4",children:[(0,r.jsx)(E.SP,{value:"basic",children:"Basic Info"}),(0,r.jsx)(E.SP,{value:"questions",children:"Questions"}),(0,r.jsx)(E.SP,{value:"settings",children:"Settings"}),(0,r.jsx)(E.SP,{value:"preview",children:"Preview"})]}),(0,r.jsx)(E.nU,{value:"basic",className:"space-y-4",children:(0,r.jsxs)(T.Zb,{children:[(0,r.jsxs)(T.Ol,{children:[(0,r.jsx)(T.ll,{children:"Template Details"}),(0,r.jsx)(T.SZ,{children:"Set the basic information for your template"})]}),(0,r.jsxs)(T.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h._,{htmlFor:"title",children:"Title"}),(0,r.jsx)(d.I,{id:"title",placeholder:"Enter template title",value:m,onChange:e=>p(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h._,{htmlFor:"description",children:"Description"}),(0,r.jsx)(u.g,{id:"description",placeholder:"Enter template description",value:x,onChange:e=>g(e.target.value),rows:4})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h._,{htmlFor:"topic",children:"Topic"}),(0,r.jsxs)(j,{value:N,onValueChange:e=>S(e),disabled:et,children:[(0,r.jsx)(w,{id:"topic",className:"w-full",children:(0,r.jsx)(b,{placeholder:"Select a topic"})}),(0,r.jsx)(k,{children:I.map(e=>(0,r.jsx)(C,{value:e.id,children:e.name},e.id))})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h._,{htmlFor:"tags",children:"Tags"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.I,{id:"tags",placeholder:"Add tags (press Enter or comma to add)",value:U,onChange:e=>V(e.target.value),onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),el())}}),(0,r.jsx)(c.z,{type:"button",onClick:el,variant:"outline",children:"Add"})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:L.map((e,t)=>(0,r.jsxs)(Z.C,{variant:"secondary",className:"px-2 py-1",children:[e,(0,r.jsx)(_.Z,{className:"ml-1 h-3 w-3 cursor-pointer",onClick:()=>ec(e)})]},t))})]})]}),(0,r.jsxs)(T.eW,{className:"flex justify-between",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>t.push("/templates"),type:"button",children:"Cancel"}),(0,r.jsx)(c.z,{type:"button",onClick:()=>K("questions"),children:"Next: Add Questions"})]})]})}),(0,r.jsx)(E.nU,{value:"questions",className:"space-y-4",children:(0,r.jsxs)(T.Zb,{children:[(0,r.jsxs)(T.Ol,{children:[(0,r.jsx)(T.ll,{children:"Template Questions"}),(0,r.jsx)(T.SZ,{children:"Add and customize questions for your template"})]}),(0,r.jsxs)(T.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f,{id:"quiz-mode",checked:W,onCheckedChange:J}),(0,r.jsx)(h._,{htmlFor:"quiz-mode",children:"Quiz Mode (allows scoring and correct answers)"})]}),W&&(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[(0,r.jsx)(f,{id:"show-score",checked:G,onCheckedChange:$}),(0,r.jsx)(h._,{htmlFor:"show-score",children:"Show score immediately after submission"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)(c.z,{type:"button",onClick:()=>en("String"),variant:"outline",className:"justify-start",children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4"}),"Short Answer Question"]}),(0,r.jsxs)(c.z,{type:"button",onClick:()=>en("Text"),variant:"outline",className:"justify-start",children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4"}),"Long Answer Question"]}),(0,r.jsxs)(c.z,{type:"button",onClick:()=>en("Int"),variant:"outline",className:"justify-start",children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4"}),"Number Question"]}),(0,r.jsxs)(c.z,{type:"button",onClick:()=>en("Checkbox"),variant:"outline",className:"justify-start",children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4"}),"Yes/No Question"]})]}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Question List"}),0===B.length?(0,r.jsx)("div",{className:"text-center p-8 border border-dashed rounded-md",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No questions added yet. Add some questions using the buttons above."})}):(0,r.jsx)(O.LB,{sensors:er,collisionDetection:O.pE,onDragEnd:e=>{let{active:t,over:s}=e;s&&t.id!==s.id&&M(e=>{let r=e.findIndex(e=>e.id===t.id),a=e.findIndex(e=>e.id===s.id);return(0,F.Rp)(e,r,a)})},children:(0,r.jsx)(F.Fo,{items:B.map(e=>e.id),strategy:F.qw,children:em.map(e=>(0,r.jsx)(Q,{field:e,onUpdateField:ei,onRemoveField:eo,isQuizMode:W},e.id))})})]})]}),(0,r.jsxs)(T.eW,{className:"flex justify-between",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>K("basic"),type:"button",children:"Previous: Basic Info"}),(0,r.jsx)(c.z,{type:"button",onClick:()=>K("settings"),children:"Next: Settings"})]})]})}),(0,r.jsx)(E.nU,{value:"settings",className:"space-y-4",children:(0,r.jsxs)(T.Zb,{children:[(0,r.jsxs)(T.Ol,{children:[(0,r.jsx)(T.ll,{children:"Template Settings"}),(0,r.jsx)(T.SZ,{children:"Configure visibility and other settings"})]}),(0,r.jsxs)(T.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f,{id:"public",checked:v,onCheckedChange:y}),(0,r.jsx)(h._,{htmlFor:"public",children:"Public Template (visible to all users)"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:v?"Anyone can view and use this template.":"Only you can view and use this template."})]}),(0,r.jsxs)(T.eW,{className:"flex justify-between",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>K("questions"),type:"button",children:"Previous: Questions"}),(0,r.jsx)(c.z,{type:"button",onClick:()=>K("preview"),children:"Next: Preview"})]})]})}),(0,r.jsx)(E.nU,{value:"preview",className:"space-y-4",children:(0,r.jsxs)(T.Zb,{children:[(0,r.jsxs)(T.Ol,{children:[(0,r.jsx)(T.ll,{children:"Template Preview"}),(0,r.jsx)(T.SZ,{children:"Review your template before creating"})]}),(0,r.jsxs)(T.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Basic Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Title"}),(0,r.jsx)("p",{className:"font-medium",children:m||"No title"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Topic"}),(0,r.jsx)("p",{className:"font-medium",children:(null===(e=I.find(e=>e.id===N))||void 0===e?void 0:e.name)||"No topic selected"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Visibility"}),(0,r.jsx)("p",{className:"font-medium",children:v?"Public":"Private"})]}),(0,r.jsxs)("div",{className:"col-span-3",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Description"}),(0,r.jsx)("p",{children:x||"No description provided"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Questions"}),B.filter(e=>e.isActive).length>0?(0,r.jsx)("div",{className:"space-y-3",children:em.filter(e=>e.isActive).map((e,t)=>{var s;return(0,r.jsxs)("div",{className:"p-4 border rounded-md",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,r.jsxs)(Z.C,{variant:"outline",children:[e.type," question"]}),W&&(0,r.jsxs)(Z.C,{children:["Worth ",e.points||0," points"]})]}),(0,r.jsxs)("p",{className:"font-medium",children:[t+1,". ",e.question||"Untitled question"]}),W&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Correct answer: ","Checkbox"===e.type?e.answer?"Yes":"No":(null===(s=e.answer)||void 0===s?void 0:s.toString())||"Not set"]})]},e.id)})}):(0,r.jsx)("div",{className:"text-center p-8 border border-dashed rounded-md",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No active questions in this template."})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Tags"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:L.length>0?L.map((e,t)=>(0,r.jsx)(Z.C,{variant:"secondary",children:e},t)):(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No tags added"})})]})]}),(0,r.jsxs)(T.eW,{className:"flex flex-col md:flex-row gap-4 justify-between items-stretch md:items-center",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>K("settings"),type:"button",className:"flex-1 md:flex-none",children:"Previous: Settings"}),(0,r.jsxs)(c.z,{variant:"secondary",type:"button",className:"flex-1 md:flex-none",onClick:()=>{let e={title:m,description:x,isPublic:v,topicId:N,tags:L,isQuiz:W,showScoreImmediately:G,questionFields:B.filter(e=>e.isActive)};localStorage.setItem("template_preview",JSON.stringify(e)),window.open("/templates/preview","_blank")},children:[(0,r.jsx)(R.Z,{className:"mr-2 h-4 w-4"}),"Full Preview"]})]}),(0,r.jsx)(c.z,{type:"submit",className:"flex-1 md:flex-none",disabled:X,children:X?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Z,{className:"mr-2 h-4 w-4"}),"Create Template"]})})]})]})})]})})]}):(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Loading..."})}},9174:function(e,t,s){"use strict";s.d(t,{C:function(){return o}});var r=s(7437);s(2265);var a=s(535),n=s(3448);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...a})}},2381:function(e,t,s){"use strict";s.d(t,{d:function(){return l},z:function(){return c}});var r=s(7437),a=s(2265),n=s(7053),i=s(535),o=s(3448);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:c=!1,...d}=e,u=c?n.Slot:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:s})),ref:t,...d})});c.displayName="Button"},9820:function(e,t,s){"use strict";s.d(t,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var r=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},279:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var r=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},5060:function(e,t,s){"use strict";s.d(t,{_:function(){return c}});var r=s(7437),a=s(2265),n=s(6394),i=s(535),o=s(3448);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.f,{ref:t,className:(0,o.cn)(l(),s),...a})});c.displayName=n.f.displayName},7168:function(e,t,s){"use strict";s.d(t,{SP:function(){return c},dr:function(){return l},mQ:function(){return o},nU:function(){return d}});var r=s(7437),a=s(2265),n=s(271),i=s(3448);let o=n.fC,l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});l.displayName=n.aV.displayName;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});c.displayName=n.xz.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,i.cn)("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});d.displayName=n.VY.displayName},3675:function(e,t,s){"use strict";s.d(t,{g:function(){return i}});var r=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});i.displayName="Textarea"},8752:function(e,t,s){"use strict";s.d(t,{Am:function(){return u},pm:function(){return m}});var r=s(2265);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,10)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=o(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_VALUE).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=r.useState(c);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},4881:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return l}});var r=s(7437),a=s(2265),n=s(2471);let i=(0,a.createContext)(null),o=e=>{let{children:t}=e,[s,o]=(0,a.useState)(null),[l,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{c(!0);try{if(n.O.isLoggedIn()){let e=await n.O.getCurrentUser();e&&e.user&&o(e.user)}}catch(e){console.error("Error initializing auth:",e),o(null)}finally{c(!1)}})()},[]);let m=async(e,t)=>{c(!0),u(null);try{let s=await n.O.login(e,t);if(s&&s.user)o(s.user);else throw Error("Login response missing user data")}catch(e){u(e.message||"Login failed"),o(null)}finally{c(!1)}},p=async(e,t,s)=>{c(!0),u(null);try{let r=await n.O.register(e,t,s);if(r&&r.user)o(r.user);else throw Error("Registration response missing user data")}catch(e){u(e.message||"Registration failed"),o(null)}finally{c(!1)}};return(0,r.jsx)(i.Provider,{value:{user:s,loading:l,error:d,login:m,register:p,logout:()=>{n.O.logout(),o(null),u(null)},clearError:()=>{u(null)}},children:t})},l=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},9642:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(3464);s(257);let a=r.Z.create({baseURL:"https://readyforms-api.vercel.app/api",timeout:15e3,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!1});a.interceptors.request.use(e=>{let t=localStorage.getItem("authToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>(console.error("API Request Error:",e),Promise.reject(e))),a.interceptors.response.use(e=>e,e=>(e.response?(console.error("API Response Error:",e.response.status,e.response.data),401===e.response.status&&console.warn("Authentication required. Redirecting to login...")):e.request?console.error("API Request Error (No Response):",e.request):console.error("API Request Setup Error:",e.message),Promise.reject(e)));var n=a},2471:function(e,t,s){"use strict";s.d(t,{O:function(){return a}});var r=s(9642);let a={async register(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"en",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"system";try{let i=await r.Z.post("/auth/register",{name:e,email:t,password:s,language:a,theme:n});return i.data.token&&localStorage.setItem("authToken",i.data.token),{success:!0,message:i.data.message||"Registration successful",token:i.data.token,user:i.data.user}}catch(e){var i;return console.error("Registration error:",e),{success:!1,message:(null===(i=e.data)||void 0===i?void 0:i.message)||"Registration failed",error:e}}},async login(e,t){try{let s=await r.Z.post("/auth/login",{email:e,password:t});return s.data.token&&localStorage.setItem("authToken",s.data.token),{success:!0,message:s.data.message||"Login successful",token:s.data.token,user:s.data.user}}catch(e){var s;return console.error("Login error:",e),{success:!1,message:(null===(s=e.data)||void 0===s?void 0:s.message)||"Login failed",error:e}}},logout(){localStorage.removeItem("authToken");let e=new CustomEvent("auth:logout",{detail:{reason:"user_logout"}});window.dispatchEvent(e)},async getCurrentUser(){try{let e=await r.Z.get("/auth/me");return{success:!0,message:"User fetched successfully",user:e.data}}catch(t){var e;return console.error("Error getting current user:",t),{success:!1,message:(null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to get current user",error:t}}},isAuthenticated:()=>!!localStorage.getItem("authToken"),async updatePreferences(e){try{let t=await r.Z.put("/auth/preferences",e);return{success:!0,message:t.data.message||"Preferences updated successfully",user:t.data.user}}catch(e){var t;return console.error("Error updating preferences:",e),{success:!1,message:(null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to update preferences",error:e}}},async forgotPassword(e){try{let t=await r.Z.post("/auth/forgot-password",{email:e});return{success:!0,message:t.data.message||"Password reset email sent"}}catch(e){var t;return console.error("Error requesting password reset:",e),{success:!1,message:(null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to request password reset",error:e}}},isLoggedIn(){if(!localStorage.getItem("authToken"))return!1;try{return!0}catch(e){return console.error("Error checking token validity:",e),!1}},getToken:()=>localStorage.getItem("authToken")}},6861:function(e,t,s){"use strict";s.d(t,{t:function(){return a}});var r=s(9642);let a={async getTemplates(e){try{return(await r.Z.get("/templates",{params:e})).data}catch(e){return console.error("Error fetching templates:",e),[]}},async getTemplateById(e){try{return(await r.Z.get("/templates/".concat(e))).data}catch(t){return console.error("Error fetching template ".concat(e,":"),t),null}},async searchTemplates(e,t){try{let s={query:e,limit:(null==t?void 0:t.limit)||10,page:(null==t?void 0:t.page)||1,topicId:null==t?void 0:t.topicId,tag:null==t?void 0:t.tag,sort:(null==t?void 0:t.sort)||"newest"};return(await r.Z.get("/templates/search",{params:s})).data}catch(e){return console.error("Error searching templates:",e),[]}},async getFeaturedTemplates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;try{return(await r.Z.get("/templates",{params:{limit:e,page:1}})).data}catch(e){return console.error("Error fetching featured templates:",e),[]}},async getTemplatesByTopic(e,t){try{return(await r.Z.get("/templates/search",{params:{topicId:e,limit:(null==t?void 0:t.limit)||10,page:(null==t?void 0:t.page)||1}})).data}catch(t){return console.error("Error fetching templates for topic ".concat(e,":"),t),[]}},async deleteTemplate(e,t){try{return await r.Z.delete("/templates/".concat(e),{data:{version:t}}),!0}catch(t){throw console.error("Error deleting template ".concat(e,":"),t),t}},async createTemplate(e){try{return(await r.Z.post("/templates",e)).data}catch(e){throw console.error("Error creating template:",e),e}},async updateTemplate(e,t){try{return(await r.Z.put("/templates/".concat(e),t)).data.template}catch(t){throw console.error("Error updating template ".concat(e,":"),t),t}}}},154:function(e,t,s){"use strict";s.d(t,{wE:function(){return n}});var r=s(9642);class a{async getAllTopics(){return(await r.Z.get("/topics")).data}async getTopicById(e){return(await r.Z.get("/topics/".concat(e))).data}async createTopic(e){return(await r.Z.post("/topics",e)).data}async updateTopic(e,t){return(await r.Z.put("/topics/".concat(e),t)).data}async deleteTopic(e,t){return(await r.Z.delete("/topics/".concat(e),{data:{version:t}})).data}}let n=new a},3448:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(1994),a=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}}},function(e){e.O(0,[284,464,513,832,788,971,117,744],function(){return e(e.s=9032)}),_N_E=e.O()}]);