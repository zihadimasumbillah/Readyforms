(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{1352:function(e,t,r){Promise.resolve().then(r.bind(r,8256))},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2735:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8736:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},5466:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},7692:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},8728:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3578:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},2369:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4369:function(e,t,r){"use strict";var s=r(2265),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=s.useState,o=s.useEffect,c=s.useLayoutEffect,i=s.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),s=a({inst:{value:r,getSnapshot:t}}),n=s[0].inst,d=s[1];return c(function(){n.value=r,n.getSnapshot=t,l(n)&&d({inst:n})},[e,r,t]),o(function(){return l(n)&&d({inst:n}),e(function(){l(n)&&d({inst:n})})},[e]),i(r),r};t.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:d},2558:function(e,t,r){"use strict";e.exports=r(4369)},8256:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var s=r(7437),n=r(2265),a=r(9376),o=r(2573),c=r(9820),i=r(2381),l=r(9140),d=r(3804),u=r(7648),m=r(2660),h=r(2735),f=r(2208),p=r(8736),x=r(9435),y=r(4881),g=r(8752);function v(e,t){if(!e)return"";let r=new Date(e);return isNaN(r.getTime())?"":new Intl.DateTimeFormat("en-US",t||{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(r)}function b(){var e;let t=(0,a.useParams)(),r=t?t.id:"",b=(0,a.useRouter)(),j=(0,y.a)(),w=null==j?void 0:j.user,N=null==j?void 0:j.logout,[k,S]=(0,n.useState)(null),[Z,A]=(0,n.useState)([]),[R,E]=(0,n.useState)(!0),[T,F]=(0,n.useState)({totalResponses:0,averageScore:0,completionRate:0});return((0,n.useEffect)(()=>{if(!(null==w?void 0:w.isAdmin)){(0,g.Am)({title:"Access denied",description:"You don't have permission to access this page",variant:"destructive"}),b.push("/dashboard");return}if(!r)return;let e=async()=>{try{E(!0);let e=await x.d.getTemplateById(r);S(e);let t=await x.d.getFormResponsesByTemplate(r);if(A(t),t&&t.length>0){if(e.isQuiz){let e=t.reduce((e,t)=>e+(t.score||0),0)/t.length;F({totalResponses:t.length,averageScore:Math.round(10*e)/10,completionRate:100})}else F({totalResponses:t.length,averageScore:0,completionRate:100})}}catch(e){console.error("Error fetching template and responses:",e),(0,g.Am)({title:"Error",description:"Failed to load template responses",variant:"destructive"})}finally{E(!1)}};w&&r&&e()},[w,r,b]),w)?(0,s.jsxs)(o.c,{user:{name:w.name||"Admin",email:w.email||"admin@example.com",isAdmin:w.isAdmin},onLogout:()=>{N&&(N(),b.push("/auth/login"))},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>b.back(),children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 mr-1"})," Back"]}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Template Responses"})]}),(0,s.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>{if(!Z||0===Z.length||!k){(0,g.Am)({title:"Export failed",description:"No data available to export",variant:"destructive"});return}try{let e=[];["String","Text","Int","Checkbox"].forEach(t=>{for(let r=1;r<=4;r++){let s="custom".concat(t).concat(r,"State");"custom".concat(t).concat(r,"Question"),k[s]&&e.push("custom".concat(t).concat(r,"Answer"))}});let t="User,Submission Date";k.isQuiz&&(t+=",Score,Total Possible Points,Percentage"),e.forEach(e=>{let r=e.match(/custom(String|Text|Int|Checkbox)(\d)Answer/);if(r){let s=k["custom".concat(r[1]).concat(r[2],"Question")]||e;t+=',"'.concat(s.replace(/"/g,'""'),'"')}}),t+="\n",Z.forEach(r=>{let s=r.user?r.user.name:"Anonymous",n=v(r.createdAt),a='"'.concat(s,'","').concat(n,'"');if(k.isQuiz){let e=r.score||0,t=r.totalPossiblePoints||0;a+=",".concat(e,",").concat(t,",").concat(t>0?Math.round(e/t*100):0,"%")}e.forEach(e=>{let t=r[e];null==t?t="":"boolean"==typeof t?t=t?"Yes":"No":"string"==typeof t&&(t='"'.concat(t.replace(/"/g,'""'),'"')),a+=",".concat(t)}),t+=a+"\n"});let r=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(r),n=document.createElement("a");n.setAttribute("href",s),n.setAttribute("download","".concat(k.title.replace(/\s+/g,"_"),"_responses.csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),(0,g.Am)({title:"Export successful",description:"Responses have been exported to CSV"})}catch(e){console.error("Error exporting to CSV:",e),(0,g.Am)({title:"Export failed",description:"Failed to export responses to CSV",variant:"destructive"})}},disabled:0===Z.length,children:[(0,s.jsx)(h.Z,{className:"h-4 w-4 mr-1"})," Export to CSV"]})]}),R?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(l.O,{className:"h-32 w-full"}),(0,s.jsx)(l.O,{className:"h-96 w-full"})]}):k?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.Zb,{className:"mb-6",children:[(0,s.jsxs)(c.Ol,{children:[(0,s.jsx)(c.ll,{className:"text-xl",children:k.title}),(0,s.jsx)(c.SZ,{children:k.description||"No description provided"})]}),(0,s.jsx)(c.aY,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Total Responses"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:T.totalResponses})]}),k.isQuiz&&(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Average Score"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[T.averageScore,(0,s.jsx)("span",{className:"text-sm ml-2 text-muted-foreground",children:"points"})]})]}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Created By"}),(0,s.jsx)("div",{className:"font-medium",children:(null===(e=k.user)||void 0===e?void 0:e.name)||"Unknown"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:v(k.createdAt)})]})]})})]}),(0,s.jsxs)(c.Zb,{children:[(0,s.jsxs)(c.Ol,{children:[(0,s.jsx)(c.ll,{className:"text-xl",children:"Response List"}),(0,s.jsx)(c.SZ,{children:"All submitted responses for this template"})]}),(0,s.jsx)(c.aY,{children:Z.length>0?(0,s.jsxs)(d.iA,{children:[(0,s.jsx)(d.xD,{children:(0,s.jsxs)(d.SC,{children:[(0,s.jsx)(d.ss,{children:"User"}),(0,s.jsx)(d.ss,{children:"Submission Date"}),k.isQuiz&&(0,s.jsx)(d.ss,{children:"Score"}),(0,s.jsx)(d.ss,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(d.RM,{children:Z.map(e=>{var t;return(0,s.jsxs)(d.SC,{children:[(0,s.jsx)(d.pj,{className:"font-medium",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"Unknown User"}),(0,s.jsx)(d.pj,{children:v(e.createdAt)}),k.isQuiz&&(0,s.jsx)(d.pj,{children:void 0!==e.score&&void 0!==e.totalPossiblePoints?(0,s.jsxs)(s.Fragment,{children:[e.score," / ",e.totalPossiblePoints,(0,s.jsxs)("span",{className:"text-xs ml-1 text-muted-foreground",children:["(",e.totalPossiblePoints>0?Math.round(e.score/e.totalPossiblePoints*100):0,"%)"]})]}):"N/A"}),(0,s.jsx)(d.pj,{className:"text-right",children:(0,s.jsx)(i.z,{variant:"outline",size:"sm",asChild:!0,children:(0,s.jsxs)(u.default,{href:"/admin/responses/".concat(e.id),children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 mr-1"})," View"]})})})]},e.id)})})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(p.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No responses yet"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"This template hasn't received any responses yet."})]})})]})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-3xl font-bold mb-2",children:"Template not found"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"The template you are looking for might have been deleted or does not exist."}),(0,s.jsx)(i.z,{onClick:()=>b.push("/admin/templates"),children:"View All Templates"})]})]}):(0,s.jsx)("div",{children:"Authenticating..."})}},9140:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});var s=r(7437),n=r(3448);function a(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-muted",t),...r})}},3804:function(e,t,r){"use strict";r.d(t,{RM:function(){return i},Rn:function(){return m},SC:function(){return l},iA:function(){return o},pj:function(){return u},ss:function(){return d},xD:function(){return c}});var s=r(7437),n=r(2265),a=r(3448);let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{className:"w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",r),...n})})});o.displayName="Table";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",r),...n})});c.displayName="TableHeader";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",r),...n})});i.displayName="TableBody",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,a.cn)("bg-primary font-medium text-primary-foreground",r),...n})}).displayName="TableFooter";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n})});l.displayName="TableRow";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n})});d.displayName="TableHead";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n})});u.displayName="TableCell";let m=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",r),...n})});m.displayName="TableCaption"},9435:function(e,t,r){"use strict";r.d(t,{d:function(){return n}});var s=r(9642);let n={async getUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{return(await s.Z.get("/admin/users?page=".concat(e,"&limit=").concat(t))).data}catch(e){throw console.error("Failed to fetch users:",e),e}},async getAllUsers(){try{return(await s.Z.get("/admin/users?limit=1000")).data.users}catch(e){throw console.error("Failed to fetch all users:",e),e}},async getUserById(e){try{return(await s.Z.get("/admin/users/".concat(e))).data}catch(t){throw console.error("Failed to fetch user ".concat(e,":"),t),t}},async toggleUserBlock(e){try{return(await s.Z.put("/admin/users/".concat(e,"/block"))).data}catch(t){throw console.error("Failed to toggle block for user ".concat(e,":"),t),t}},async toggleUserAdmin(e){try{return(await s.Z.put("/admin/users/".concat(e,"/admin"))).data}catch(t){throw console.error("Failed to toggle admin for user ".concat(e,":"),t),t}},async getDashboardStats(){try{return(await s.Z.get("/admin/dashboard-stats")).data}catch(e){throw console.error("Failed to fetch dashboard stats:",e),e}},async getSystemActivity(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{return(await s.Z.get("/admin/system-activity/".concat(e))).data}catch(e){throw console.error("Failed to fetch system activity:",e),e}},async getAllTemplates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{return(await s.Z.get("/admin/templates?page=".concat(e,"&limit=").concat(t))).data.templates}catch(e){throw console.error("Failed to fetch templates:",e),e}},async getAllTopics(){try{return(await s.Z.get("/admin/topics")).data}catch(e){throw console.error("Failed to fetch topics:",e),e}},async getTemplateById(e){try{return(await s.Z.get("/admin/templates/".concat(e))).data}catch(t){throw console.error("Failed to fetch template ".concat(e,":"),t),t}},async getAllResponses(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{return(await s.Z.get("/admin/responses?page=".concat(e,"&limit=").concat(t))).data.responses}catch(e){throw console.error("Failed to fetch responses:",e),e}},async getFormResponseById(e){try{return(await s.Z.get("/admin/responses/".concat(e))).data}catch(t){throw console.error("Failed to fetch form response ".concat(e,":"),t),t}},async deleteFormResponse(e){try{await s.Z.delete("/admin/responses/".concat(e))}catch(t){throw console.error("Failed to delete form response ".concat(e,":"),t),t}},async getFormResponsesByTemplate(e){try{return(await s.Z.get("/admin/templates/".concat(e,"/responses"))).data}catch(t){throw console.error("Failed to fetch responses for template ".concat(e,":"),t),t}},async getUsersCount(){try{return(await s.Z.get("/admin/users-count")).data.count}catch(e){throw console.error("Failed to fetch users count:",e),e}}}},1146:function(e,t,r){"use strict";r.d(t,{NY:function(){return k},Ee:function(){return N},fC:function(){return w}});var s=r(2265),n=r(3966),a=r(6606),o=r(1188),c=r(6840),i=r(2558);function l(){return()=>{}}var d=r(7437),u="Avatar",[m,h]=(0,n.b)(u),[f,p]=m(u),x=s.forwardRef((e,t)=>{let{__scopeAvatar:r,...n}=e,[a,o]=s.useState("idle");return(0,d.jsx)(f,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:(0,d.jsx)(c.WV.span,{...n,ref:t})})});x.displayName=u;var y="AvatarImage",g=s.forwardRef((e,t)=>{let{__scopeAvatar:r,src:n,onLoadingStatusChange:u=()=>{},...m}=e,h=p(y,r),f=function(e,t){let{referrerPolicy:r,crossOrigin:n}=t,a=(0,i.useSyncExternalStore)(l,()=>!0,()=>!1),c=s.useRef(null),d=a?(c.current||(c.current=new window.Image),c.current):null,[u,m]=s.useState(()=>j(d,e));return(0,o.b)(()=>{m(j(d,e))},[d,e]),(0,o.b)(()=>{let e=e=>()=>{m(e)};if(!d)return;let t=e("loaded"),s=e("error");return d.addEventListener("load",t),d.addEventListener("error",s),r&&(d.referrerPolicy=r),"string"==typeof n&&(d.crossOrigin=n),()=>{d.removeEventListener("load",t),d.removeEventListener("error",s)}},[d,n,r]),u}(n,m),x=(0,a.W)(e=>{u(e),h.onImageLoadingStatusChange(e)});return(0,o.b)(()=>{"idle"!==f&&x(f)},[f,x]),"loaded"===f?(0,d.jsx)(c.WV.img,{...m,ref:t,src:n}):null});g.displayName=y;var v="AvatarFallback",b=s.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:n,...a}=e,o=p(v,r),[i,l]=s.useState(void 0===n);return s.useEffect(()=>{if(void 0!==n){let e=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(e)}},[n]),i&&"loaded"!==o.imageLoadingStatus?(0,d.jsx)(c.WV.span,{...a,ref:t}):null});function j(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}b.displayName=v;var w=x,N=g,k=b}},function(e){e.O(0,[284,464,972,513,832,331,128,713,582,971,117,744],function(){return e(e.s=1352)}),_N_E=e.O()}]);