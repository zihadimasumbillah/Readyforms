"use strict";exports.id=927,exports.ids=[927],exports.modules={6927:(e,s,t)=>{t.d(s,{O:()=>k});var r=t(326),i=t(7577),a=t(4723),l=t(4064),n=t(7256),d=t(1190),o=t(1223);let c=i.forwardRef(({className:e,...s},t)=>r.jsx("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));c.displayName="Textarea";var m=t(3635),u=t(2933);let x=i.forwardRef(({className:e,...s},t)=>r.jsx(m.fC,{ref:t,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:r.jsx(m.z$,{className:(0,o.cn)("flex items-center justify-center text-current"),children:r.jsx(u.Z,{className:"h-4 w-4"})})}));x.displayName=m.fC.displayName;var f=t(1664),h=t(9008),p=t(9280),j=t(815),g=t(7197),b=t(2616),N=t(6812),v=t(7035);function y({id:e,label:s,enabled:t,question:i,onToggle:a,onQuestionChange:l,onDelete:n,maxFields:o=4,currentFieldCount:c=0}){let{attributes:m,listeners:u,setNodeRef:h,transform:p,transition:j}=(0,g.nB)({id:e}),y={transform:b.ux.Transform.toString(p),transition:j,opacity:t?1:.5};return(0,r.jsxs)("div",{ref:h,style:y,className:"mb-4 border rounded-md p-4 bg-background",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{...m,...u,className:"cursor-grab p-1",children:r.jsx(N.W1P,{className:"h-5 w-5 text-muted-foreground"})}),r.jsx("h4",{className:"font-medium",children:s})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[c&&c>1&&r.jsx(f.z,{variant:"ghost",size:"sm",onClick:n,className:"h-8 w-8 p-0",title:"Remove question",children:r.jsx(v.Z,{className:"h-4 w-4 text-muted-foreground"})}),r.jsx(x,{id:`toggle-${e}`,checked:t,onCheckedChange:a})]})]}),r.jsx("div",{className:`transition-all ${t?"opacity-100":"opacity-50"}`,children:r.jsx(d.I,{value:i,onChange:e=>l(e.target.value),placeholder:"Enter question text",disabled:!t,className:"mt-2"})})]})}var w=t(1996),$=t(6627);let C=n.Ry({title:n.Z_().min(3,{message:"Title must be at least 3 characters"}),description:n.Z_(),topicId:n.Z_().min(1,{message:"Please select a topic"}),isPublic:n.O7().default(!0),allowedUsers:n.Z_().optional()}),k=({initialData:e,topics:s,onSubmit:t,submitButtonLabel:n,isEditMode:o=!1})=>{let[m,u]=(0,i.useState)(e||{}),[b,N]=(0,i.useState)(e?.questionOrder?JSON.parse(e.questionOrder):[]),[v,k]=(0,i.useState)(!1),S=(0,a.cI)({resolver:(0,l.F)(C),defaultValues:{title:e?.title||"",description:e?.description||"",topicId:e?.topicId||"",isPublic:e?.isPublic===void 0||e.isPublic,allowedUsers:e?.allowedUsers||""}}),I=(0,j.Dy)((0,j.VT)(j.we),(0,j.VT)(j.Lg,{coordinateGetter:g.is})),z=(e,s)=>{if(!m)return;let t=`${e}State`;u({...m,[t]:s}),s&&!b.includes(e)&&N([...b,e])},F=(e,s)=>{if(!m)return;let t=`${e}Question`;u({...m,[t]:s})},T=e=>{if(m){for(let s=1;s<=4;s++){let t=`custom${e}${s}`,r=`${t}State`;if(!m[r]){z(t,!0);let s=`${t}Question`;u({...m,[r]:!0,[s]:`New ${e} Question`}),b.includes(t)||N([...b,t]);return}}(0,$.Am)({title:"Maximum fields reached",description:`You can have at most 4 ${e.toLowerCase()} questions.`,variant:"default"})}},P=e=>{if(!m)return;let s=`${e}State`;u({...m,[s]:!1}),N(b.filter(s=>s!==e))},R=e=>{if(!m)return 0;let s=0;for(let t=1;t<=4;t++)m[`custom${e}${t}State`]&&s++;return s},q=async e=>{try{k(!0);let s={...e,version:m.version,questionOrder:JSON.stringify(b)};for(let e=1;e<=4;e++)["String","Text","Int","Checkbox"].forEach(t=>{let r=`custom${t}${e}`,i=`${r}State`,a=`${r}Question`;s[i]=m[i]||!1,s[a]=m[a]||""});await t(s)}catch(e){console.error("Error saving template:",e),(0,$.Am)({title:"Error",description:"Failed to save template. Please try again.",variant:"destructive"})}finally{k(!1)}};return r.jsx("div",{className:"space-y-6",children:r.jsx("div",{className:"space-y-4",children:r.jsx(h.l0,{...S,children:(0,r.jsxs)("form",{onSubmit:S.handleSubmit(q),className:"space-y-6",children:[r.jsx(h.Wi,{control:S.control,name:"title",render:({field:e})=>(0,r.jsxs)(h.xJ,{children:[r.jsx(h.lX,{children:"Template Title"}),r.jsx(h.NI,{children:r.jsx(d.I,{placeholder:"Enter template title",...e})}),r.jsx(h.zG,{})]})}),r.jsx(h.Wi,{control:S.control,name:"description",render:({field:e})=>(0,r.jsxs)(h.xJ,{children:[r.jsx(h.lX,{children:"Description"}),r.jsx(h.NI,{children:r.jsx(c,{placeholder:"Enter a description of this template",...e})}),r.jsx(h.zG,{})]})}),r.jsx(h.Wi,{control:S.control,name:"topicId",render:({field:e})=>(0,r.jsxs)(h.xJ,{children:[r.jsx(h.lX,{children:"Topic"}),(0,r.jsxs)(p.Ph,{onValueChange:e.onChange,defaultValue:e.value,children:[r.jsx(h.NI,{children:r.jsx(p.i4,{children:r.jsx(p.ki,{placeholder:"Select a topic"})})}),r.jsx(p.Bw,{children:s.map(e=>r.jsx(p.Ql,{value:e.id,children:e.name},e.id))})]}),r.jsx(h.zG,{})]})}),r.jsx(h.Wi,{control:S.control,name:"isPublic",render:({field:e})=>(0,r.jsxs)(h.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[r.jsx(h.NI,{children:r.jsx(x,{checked:e.value,onCheckedChange:e.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[r.jsx(h.lX,{children:"Make this template public"}),r.jsx(h.pf,{children:"Public templates are visible to all users. Private templates are only visible to you."})]})]})}),(0,r.jsxs)("div",{className:"bg-muted/20 border rounded-md p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium",children:"Questions"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Add and configure questions for your form"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>T("String"),disabled:R("String")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Text Field"]}),(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>T("Text"),disabled:R("Text")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Text Area"]}),(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>T("Int"),disabled:R("Int")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Number"]}),(0,r.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>T("Checkbox"),disabled:R("Checkbox")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Checkbox"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2 py-2",children:[r.jsx(j.LB,{sensors:I,collisionDetection:j.pE,onDragEnd:e=>{let{active:s,over:t}=e;t&&s.id!==t.id&&N(e=>{let r=e.indexOf(s.id.toString()),i=e.indexOf(t.id.toString());return(0,g.Rp)(e,r,i)})},children:r.jsx(g.Fo,{items:b,strategy:g.qw,children:b.map(e=>{let s;let t=`${e}State`,i=`${e}Question`,a=e.match(/custom([A-Za-z]+)(\d)/);if(!a)return null;let[,l,n]=a;switch(l){case"String":s=`Text Field ${n}`;break;case"Text":s=`Text Area ${n}`;break;case"Int":s=`Number ${n}`;break;case"Checkbox":s=`Checkbox ${n}`;break;default:s=`Question ${n}`}return r.jsx(y,{id:e,label:s,enabled:m[t]||!1,question:m[i]||"",onToggle:s=>z(e,s),onQuestionChange:s=>F(e,s),onDelete:()=>P(e),currentFieldCount:b.filter(e=>e.includes(l)).length,maxFields:4},e)})})}),0===b.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"No questions yet"}),r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add questions using the buttons above"})]})]})]}),r.jsx("div",{className:"flex justify-end space-x-2",children:r.jsx(f.z,{type:"submit",disabled:v,children:v?"Saving...":n})})]})})})})}},9008:(e,s,t)=>{t.d(s,{l0:()=>m,NI:()=>g,pf:()=>b,Wi:()=>x,xJ:()=>p,lX:()=>j,zG:()=>N});var r=t(326),i=t(7577),a=t(4214),l=t(4723),n=t(1223),d=t(4478);let o=(0,t(9360).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=i.forwardRef(({className:e,...s},t)=>r.jsx(d.f,{ref:t,className:(0,n.cn)(o(),e),...s}));c.displayName=d.f.displayName;let m=l.RV,u=i.createContext({}),x=({...e})=>r.jsx(u.Provider,{value:{name:e.name},children:r.jsx(l.Qr,{...e})}),f=()=>{let e=i.useContext(u),s=i.useContext(h),{getFieldState:t,formState:r}=(0,l.Gc)(),a=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=s;return{id:n,name:e.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...a}},h=i.createContext({}),p=i.forwardRef(({className:e,...s},t)=>{let a=i.useId();return r.jsx(h.Provider,{value:{id:a},children:r.jsx("div",{ref:t,className:(0,n.cn)("space-y-2",e),...s})})});p.displayName="FormItem";let j=i.forwardRef(({className:e,...s},t)=>{let{error:i,formItemId:a}=f();return r.jsx(c,{ref:t,className:(0,n.cn)(i&&"text-destructive",e),htmlFor:a,...s})});j.displayName="FormLabel";let g=i.forwardRef(({...e},s)=>{let{error:t,formItemId:i,formDescriptionId:l,formMessageId:n}=f();return r.jsx(a.g7,{ref:s,id:i,"aria-describedby":t?`${l} ${n}`:`${l}`,"aria-invalid":!!t,...e})});g.displayName="FormControl";let b=i.forwardRef(({className:e,...s},t)=>{let{formDescriptionId:i}=f();return r.jsx("p",{ref:t,id:i,className:(0,n.cn)("text-sm text-muted-foreground",e),...s})});b.displayName="FormDescription";let N=i.forwardRef(({className:e,children:s,...t},i)=>{let{error:a,formMessageId:l}=f(),d=a?String(a?.message):s;return d?r.jsx("p",{ref:i,id:l,className:(0,n.cn)("text-sm font-medium text-destructive",e),...t,children:d}):null});N.displayName="FormMessage"}};