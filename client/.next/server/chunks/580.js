"use strict";exports.id=580,exports.ids=[580],exports.modules={66927:(e,t,s)=>{s.d(t,{O:()=>k});var r=s(10326),a=s(17577),i=s(74723),l=s(74064),n=s(27256),d=s(41190),o=s(51223);let c=a.forwardRef(({className:e,...t},s)=>r.jsx("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));c.displayName="Textarea";var m=s(13635),u=s(32933);let x=a.forwardRef(({className:e,...t},s)=>r.jsx(m.fC,{ref:s,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:r.jsx(m.z$,{className:(0,o.cn)("flex items-center justify-center text-current"),children:r.jsx(u.Z,{className:"h-4 w-4"})})}));x.displayName=m.fC.displayName;var p=s(91664),f=s(59008),h=s(29280),j=s(40815),g=s(77197),b=s(82616),v=s(76812),N=s(47035);function y({id:e,label:t,enabled:s,question:a,onToggle:i,onQuestionChange:l,onDelete:n,maxFields:o=4,currentFieldCount:c=0}){let{attributes:m,listeners:u,setNodeRef:f,transform:h,transition:j}=(0,g.nB)({id:e}),y={transform:b.ux.Transform.toString(h),transition:j,opacity:s?1:.5};return(0,r.jsxs)("div",{ref:f,style:y,className:"mb-4 border rounded-md p-4 bg-background",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{...m,...u,className:"cursor-grab p-1",children:r.jsx(v.W1P,{className:"h-5 w-5 text-muted-foreground"})}),r.jsx("h4",{className:"font-medium",children:t})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[c&&c>1&&r.jsx(p.z,{variant:"ghost",size:"sm",onClick:n,className:"h-8 w-8 p-0",title:"Remove question",children:r.jsx(N.Z,{className:"h-4 w-4 text-muted-foreground"})}),r.jsx(x,{id:`toggle-${e}`,checked:s,onCheckedChange:i})]})]}),r.jsx("div",{className:`transition-all ${s?"opacity-100":"opacity-50"}`,children:r.jsx(d.I,{value:a,onChange:e=>l(e.target.value),placeholder:"Enter question text",disabled:!s,className:"mt-2"})})]})}var w=s(51996),$=s(56627);let C=n.Ry({title:n.Z_().min(3,{message:"Title must be at least 3 characters"}),description:n.Z_(),topicId:n.Z_().min(1,{message:"Please select a topic"}),isPublic:n.O7().default(!0),allowedUsers:n.Z_().optional()}),k=({initialData:e,topics:t,onSubmit:s,submitButtonLabel:n,isEditMode:o=!1})=>{let[m,u]=(0,a.useState)(e||{}),[b,v]=(0,a.useState)(e?.questionOrder?JSON.parse(e.questionOrder):[]),[N,k]=(0,a.useState)(!1),I=(0,i.cI)({resolver:(0,l.F)(C),defaultValues:{title:e?.title||"",description:e?.description||"",topicId:e?.topicId||"",isPublic:e?.isPublic===void 0||e.isPublic,allowedUsers:e?.allowedUsers||""}}),S=(0,j.Dy)((0,j.VT)(j.we),(0,j.VT)(j.Lg,{coordinateGetter:g.is})),T=(e,t)=>{if(!m)return;let s=`${e}State`;u({...m,[s]:t}),t&&!b.includes(e)&&v([...b,e])},z=(e,t)=>{if(!m)return;let s=`${e}Question`;u({...m,[s]:t})},F=e=>{if(m){for(let t=1;t<=4;t++){let s=`custom${e}${t}`,r=`${s}State`;if(!m[r]){T(s,!0);let t=`${s}Question`;u({...m,[r]:!0,[t]:`New ${e} Question`}),b.includes(s)||v([...b,s]);return}}(0,$.Am)({title:"Maximum fields reached",description:`You can have at most 4 ${e.toLowerCase()} questions.`,variant:"default"})}},Z=e=>{if(!m)return;let t=`${e}State`;u({...m,[t]:!1}),v(b.filter(t=>t!==e))},P=e=>{if(!m)return 0;let t=0;for(let s=1;s<=4;s++)m[`custom${e}${s}State`]&&t++;return t},A=async e=>{try{k(!0);let t={...e,version:m.version,questionOrder:JSON.stringify(b)};for(let e=1;e<=4;e++)["String","Text","Int","Checkbox"].forEach(s=>{let r=`custom${s}${e}`,a=`${r}State`,i=`${r}Question`;t[a]=m[a]||!1,t[i]=m[i]||""});await s(t)}catch(e){console.error("Error saving template:",e),(0,$.Am)({title:"Error",description:"Failed to save template. Please try again.",variant:"destructive"})}finally{k(!1)}};return r.jsx("div",{className:"space-y-6",children:r.jsx("div",{className:"space-y-4",children:r.jsx(f.l0,{...I,children:(0,r.jsxs)("form",{onSubmit:I.handleSubmit(A),className:"space-y-6",children:[r.jsx(f.Wi,{control:I.control,name:"title",render:({field:e})=>(0,r.jsxs)(f.xJ,{children:[r.jsx(f.lX,{children:"Template Title"}),r.jsx(f.NI,{children:r.jsx(d.I,{placeholder:"Enter template title",...e})}),r.jsx(f.zG,{})]})}),r.jsx(f.Wi,{control:I.control,name:"description",render:({field:e})=>(0,r.jsxs)(f.xJ,{children:[r.jsx(f.lX,{children:"Description"}),r.jsx(f.NI,{children:r.jsx(c,{placeholder:"Enter a description of this template",...e})}),r.jsx(f.zG,{})]})}),r.jsx(f.Wi,{control:I.control,name:"topicId",render:({field:e})=>(0,r.jsxs)(f.xJ,{children:[r.jsx(f.lX,{children:"Topic"}),(0,r.jsxs)(h.Ph,{onValueChange:e.onChange,defaultValue:e.value,children:[r.jsx(f.NI,{children:r.jsx(h.i4,{children:r.jsx(h.ki,{placeholder:"Select a topic"})})}),r.jsx(h.Bw,{children:t.map(e=>r.jsx(h.Ql,{value:e.id,children:e.name},e.id))})]}),r.jsx(f.zG,{})]})}),r.jsx(f.Wi,{control:I.control,name:"isPublic",render:({field:e})=>(0,r.jsxs)(f.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[r.jsx(f.NI,{children:r.jsx(x,{checked:e.value,onCheckedChange:e.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[r.jsx(f.lX,{children:"Make this template public"}),r.jsx(f.pf,{children:"Public templates are visible to all users. Private templates are only visible to you."})]})]})}),(0,r.jsxs)("div",{className:"bg-muted/20 border rounded-md p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium",children:"Questions"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Add and configure questions for your form"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>F("String"),disabled:P("String")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Text Field"]}),(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>F("Text"),disabled:P("Text")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Text Area"]}),(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>F("Int"),disabled:P("Int")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Number"]}),(0,r.jsxs)(p.z,{variant:"outline",size:"sm",onClick:()=>F("Checkbox"),disabled:P("Checkbox")>=4,className:"gap-1",type:"button",children:[r.jsx(w.Z,{className:"h-3.5 w-3.5"}),"Add Checkbox"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2 py-2",children:[r.jsx(j.LB,{sensors:S,collisionDetection:j.pE,onDragEnd:e=>{let{active:t,over:s}=e;s&&t.id!==s.id&&v(e=>{let r=e.indexOf(t.id.toString()),a=e.indexOf(s.id.toString());return(0,g.Rp)(e,r,a)})},children:r.jsx(g.Fo,{items:b,strategy:g.qw,children:b.map(e=>{let t;let s=`${e}State`,a=`${e}Question`,i=e.match(/custom([A-Za-z]+)(\d)/);if(!i)return null;let[,l,n]=i;switch(l){case"String":t=`Text Field ${n}`;break;case"Text":t=`Text Area ${n}`;break;case"Int":t=`Number ${n}`;break;case"Checkbox":t=`Checkbox ${n}`;break;default:t=`Question ${n}`}return r.jsx(y,{id:e,label:t,enabled:m[s]||!1,question:m[a]||"",onToggle:t=>T(e,t),onQuestionChange:t=>z(e,t),onDelete:()=>Z(e),currentFieldCount:b.filter(e=>e.includes(l)).length,maxFields:4},e)})})}),0===b.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"No questions yet"}),r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add questions using the buttons above"})]})]})]}),r.jsx("div",{className:"flex justify-end space-x-2",children:r.jsx(p.z,{type:"submit",disabled:N,children:N?"Saving...":n})})]})})})})}},59008:(e,t,s)=>{s.d(t,{l0:()=>m,NI:()=>g,pf:()=>b,Wi:()=>x,xJ:()=>h,lX:()=>j,zG:()=>v});var r=s(10326),a=s(17577),i=s(34214),l=s(74723),n=s(51223),d=s(34478);let o=(0,s(79360).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(({className:e,...t},s)=>r.jsx(d.f,{ref:s,className:(0,n.cn)(o(),e),...t}));c.displayName=d.f.displayName;let m=l.RV,u=a.createContext({}),x=({...e})=>r.jsx(u.Provider,{value:{name:e.name},children:r.jsx(l.Qr,{...e})}),p=()=>{let e=a.useContext(u),t=a.useContext(f),{getFieldState:s,formState:r}=(0,l.Gc)(),i=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...i}},f=a.createContext({}),h=a.forwardRef(({className:e,...t},s)=>{let i=a.useId();return r.jsx(f.Provider,{value:{id:i},children:r.jsx("div",{ref:s,className:(0,n.cn)("space-y-2",e),...t})})});h.displayName="FormItem";let j=a.forwardRef(({className:e,...t},s)=>{let{error:a,formItemId:i}=p();return r.jsx(c,{ref:s,className:(0,n.cn)(a&&"text-destructive",e),htmlFor:i,...t})});j.displayName="FormLabel";let g=a.forwardRef(({...e},t)=>{let{error:s,formItemId:a,formDescriptionId:l,formMessageId:n}=p();return r.jsx(i.g7,{ref:t,id:a,"aria-describedby":s?`${l} ${n}`:`${l}`,"aria-invalid":!!s,...e})});g.displayName="FormControl";let b=a.forwardRef(({className:e,...t},s)=>{let{formDescriptionId:a}=p();return r.jsx("p",{ref:s,id:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...t})});b.displayName="FormDescription";let v=a.forwardRef(({className:e,children:t,...s},a)=>{let{error:i,formMessageId:l}=p(),d=i?String(i?.message):t;return d?r.jsx("p",{ref:a,id:l,className:(0,n.cn)("text-sm font-medium text-destructive",e),...s,children:d}):null});v.displayName="FormMessage"},48453:(e,t,s)=>{var r=s(71922);class a{async getAllTopics(){return(await r.Z.get("/topics")).data}async getTopicById(e){return(await r.Z.get(`/topics/${e}`)).data}async createTopic(e){return(await r.Z.post("/topics",e)).data}async updateTopic(e,t){return(await r.Z.put(`/topics/${e}`,t)).data}async deleteTopic(e,t){return(await r.Z.delete(`/topics/${e}`,{data:{version:t}})).data}}new a}};